<%- include('../includes/head') %>
<%- include('../includes/nav') %>

<main class="cart-container">
  <h1>Your Cart</h1>

  <% if (products.length === 0) { %>
    <p>Your cart is currently empty.</p>
  <% } else { %>
    <section class="cart-items">
      <% let totalPrice = 0; %>
      <% products.forEach(item => { 
           totalPrice += item.productData.price * item.qty;
      %>
        <div class="cart-item">
          <div class="item-details">
            <h2><%= item.productData.title %></h2>
            <p>Price: ₦<%= parseFloat(item.productData.price).toFixed(2) %></p>
            <p>Quantity: <%= item.qty %></p>
            <p>Subtotal: ₦<%= (parseFloat(item.productData.price) * item.qty).toFixed(2) %></p>
          </div>

          <div class="item-actions">
            <form action="/cart-delete-item" method="POST">
              <input type="hidden" name="productId" value="<%= item.productData.id %>">
              <button class="btn btn-danger" type="submit">Delete</button>
            </form>
          </div>
        </div>
      <% }) %>
    </section>

    <div class="cart-summary">
      <h3>Total: ₦<%= totalPrice.toFixed(2) %></h3>
      <form action="/checkout" method="POST">
        <button class="btn" type="submit">Proceed to Checkout</button>
      </form>
    </div>
  <% } %>
</main>

<%- include('../includes/end') %>
